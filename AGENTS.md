# AGENTS

## 目的
- マイナポータルの医療費CSVを、国税庁「医療費集計フォーム v3.1」に貼り付け可能なCSVへ変換する。
- 変換はブラウザ内のみで完結し、サーバーにアップロードしない。

## 変換仕様
- 入力: `key,value` の連続行（マイナポータル形式）。
- 明細キー: `診療年月`, `診療区分`, `日数`, `医療機関等名称`, `医療費の総額（円）`, `保険者の負担額（円）`, `その他の公費の負担額（円）`, `窓口相当負担額（円）`。
- 出力: ヘッダーなし・9列。
  - `医療を受けた人`, `病院・薬局などの名称`, `診療・治療`, `医薬品購入`, `介護保険サービス`, `その他の医療費`, `支払った医療費の金額`, `左のうち、補填される金額`, `支払年月日`
- 区分列は該当列に `"該当する"` を入れる。
- `支払った医療費の金額` は `窓口相当負担額（円）` を使用。
- `補填額` は空欄。
- `診療年月` は **`YYYY年M月` / `YYYY年MM月`**。支払年月日は `MM/01/YYYY` で出力。

## 区分判定
- `診療区分` に `調剤` / `薬` / `医薬品` を含む → `医薬品購入`
- `診療区分` に `介護` を含む → `介護保険サービス`
- それ以外 → `診療・治療`

## ビルド/デプロイ
- Zig: `0.15.2`
- `zig build -Doptimize=ReleaseSmall` で `vite build` まで実行し、`dist/` を生成。
- ローカル確認は `zig build serve` を使い、`bun --bun vite preview --host` で配信する。
- `file://` ではWASMが読み込めないため不可。
- GitHub Actions で `gh-pages` ブランチにデプロイ（Bunでbuild）。
